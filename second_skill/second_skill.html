<!DOCTYPE html> 
<html> 
<head> 
<meta charset="utf-8" > 
<title>second_skill(day,hour,min,sec)</title> 
<script type="text/javascript" src="http://res.gbhui.com/res/mall/js/common/jquery-1.7.2.min.js"></script>
</head> 
<!-- <body onload="leftTimer()">  -->
<body>
  	<div class="activity_time_list001">
		<p class="activity_start_time" activityend='2017,12,16 19:00:00'>2017,12,06 16:30:00</p>
		<p class="activity_status"></p>
	</div>
<!-- <h2>剩余时间:</h2> 
<div id="timer"></div>
 -->
<script language="javascript" type="text/javascript"> 
$(document).ready(function(){
		var nowdate = new Date();
		var nowyear = String(nowdate.getFullYear()); //2017
		var nowmonth = String(nowdate.getMonth()+1); //12
		var nowday = String(nowdate.getDate());  //06 
		var nowhour = String(nowdate.getHours()); 
		var nowmin = String(nowdate.getMinutes()); 
		var nowsec = String(nowdate.getSeconds());  
		var now = nowyear+nowmonth+nowday+nowhour+nowmin+nowsec;
		now = Number(now);
		/*var nowday = nowdate.getDate(); //获取当前日 by sweety
		var nowhour = nowdate.getHours();
		var nowmin = nowdate.getMinutes();
		var now = nowday * 24 * 3600 * 1000  + nowhour * 3600 * 1000 + nowmin * 60 * 1000;
		var num = '';*/
		//console.log(now);
		$('.activity_time_list001').each(function(){
			var startdate = $(this).children('.activity_start_time').text();
			var startyear = startdate.substring(0,4); //2017
			var startmonth = startdate.substring(5,7); //12
			var startday = startdate.substring(8,10);  //06 
			var starthour = startdate.substring(11,13); 
			var startmin = startdate.substring(14,16);
			var startsec = startdate.substring(17,19);    
			var start = startyear+startmonth+startday+starthour+startmin+startsec;
			start = Number(start);
			//var start =startday * 24 * 3600 * 1000 + starthour * 3600 * 1000 + startmin * 60 * 1000;
		   //var start = starthour * 3600 * 1000 + startmin * 60 * 1000; sweety
			var enddate = $(this).children('.activity_start_time').attr('activityend');
			var endyear = enddate.substring(0,4); //2017
			var endmonth = enddate.substring(5,7); //12
			var endday = enddate.substring(8,10);  //06 
			var endhour = enddate.substring(11,13); 
			var endmin = enddate.substring(14,16);
			var endsec = enddate.substring(17,19);   
			var end = endyear+endmonth+endday+endhour+endmin+endsec;
			end = Number(end);
			//var end = endday *24 * 3600 * 1000 +endhour * 3600 * 1000 + endmin * 60 * 1000;
			//var end = endhour * 3600 * 1000 + endmin * 60 * 1000;
			//var leftTime = startdate - nowdate;
			function checkTime(i){ //将0-9的数字前面加上0，例1变为01 
			 if(i<10) 
			 { 
			  i = "0" + i; 
			 } 
			 return i; 
			} 
			if(now > end){
				console.log('now>end');
				$(this).children('.activity_status').text('close');
			}
			if(now < start){
				console.log('now<start');
				$(this).children('.activity_status').text('Not start left start : ');
				//start-now
				var endTime = new Date(endyear,endmonth-1,endday,endhour,endmin,endsec);
				var leftTime = endTime - nowdate;
				console.log(leftTime);
				//var leftTime = (new Date(endyear,endmonth,endday,endhour,endmin,endsec)) - (new Date());
				//var leftTime = (new Date(Number(endyear),Number(endmonth),Number(endday),Number(endhour),Number(endmin),Number(endsec))) - (new Date());
				console.log(new Date());
				var days = parseInt(leftTime / 1000 / 60 / 60 / 24 , 10); //计算剩余的天数 
				var hours = parseInt(leftTime / 1000 / 60 / 60 % 24 , 10); //计算剩余的小时 
				var minutes = parseInt(leftTime / 1000 / 60 % 60, 10);//计算剩余的分钟 
				var seconds = parseInt(leftTime / 1000 % 60, 10);//计算剩余的秒数 
				days = checkTime(days); 
				hours = checkTime(hours); 
				minutes = checkTime(minutes); 
				seconds = checkTime(seconds);
				console.log('left day:'+ days+'  days,'+hours+'  hours,'+minutes+'  mins,'+seconds+'  secs');
				return false;
			}
			if(now > start && now < end){
				console.log('now > start && now < end');
				$(this).children('.activity_status').text('进行中');
				return false;
			}
		})
	})
</script>
</body>
